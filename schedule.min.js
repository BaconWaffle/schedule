if(Array.prototype.indexOf||(Array.prototype.indexOf=function(e){"use strict";if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0===n)return-1;var r=0;if(arguments.length>1&&(r=Number(arguments[1]),r!=r?r=0:0!=r&&1/0!=r&&r!=-1/0&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=n)return-1;for(var i=r>=0?r:Math.max(n-Math.abs(r),0);n>i;i++)if(i in t&&t[i]===e)return i;return-1}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),function(){"use strict";var e=function(e,t){var n=t||!1,r="get"+(n?"":"UTC"),i=!0,a=1e3,u=60*a,l=60*u,s=24*l,o=Math.ceil,c=Math.floor,f=Math.max,g=Date.prototype,h=g[r+"FullYear"],m=g[r+"Month"],d=g[r+"Date"],v=g[r+"Day"],T=g[r+"Hours"],p=g[r+"Minutes"],w=g[r+"Seconds"];e=void 0===e?1:e;var x=function(e,t,n){for(var r,i=null,a=t[0],u=t.length;u--;){if(r=t[u],r===e)return e;a=a>r?r:a,i=r>e&&(!i||i>r)?r:i}return i||(void 0===n?a:a+n)},y=function(e,t,n){for(var r,i=null,a=t.length,u=t[a-1];a--;){if(r=t[a],r===e)return e;u=r>u?r:u,i=e>r&&(!i||r>i)?r:i}return null!==i?i:void 0===n?u:u-n},D=function(e,t,r,i,a,u){return t=void 0===t?0:t,r=void 0===r?1:r,i=void 0===i?0:i,a=void 0===a?0:a,u=void 0===u?0:u,n?new Date(e,t,r,i,a,u):new Date(Date.UTC(e,t,r,i,a,u))},M=function(e,t,r,i,a,u){return t=void 0===t?11:t,r=void 0===r?d.call(D(e,t+1,0)):r,i=void 0===i?23:i,a=void 0===a?59:a,u=void 0===u?59:u,n?new Date(e,t,r,i,a,u):new Date(Date.UTC(e,t,r,i,a,u))},b=function(e){return(10>e?"0":"")+e},O=function(e,t,n){var r,i,a,u,l,f,g,O,S,k,E,N,Y,W,C,L,q,A,I,P,U,V,j,F=n?y:x,H=n?M:D;return r=h.call(t),i=m.call(t),a=d.call(t),l=T.call(t),f=p.call(t),g=w.call(t),Y=b(l)+":"+b(f)+":"+b(g),e.t&&F(Y,e.t)===Y?n?H(r,i,a,l,f,g-1):H(r,i,a,l,f,g+1):e.s&&F(g,e.s,60)===g?n?H(r,i,a,l,f,g-1):H(r,i,a,l,f,g+1):e.m&&F(f,e.m,60)===f?n?H(r,i,a,l,f-1):H(r,i,a,l,f+1):e.h&&F(l,e.h,24)===l?n?H(r,i,a,l-1):H(r,i,a,l+1):e.tb&&e.tb[0]>Y?(j=e.tb[0].split(":"),n?H(r,i,a-1,j[0],j[1],j[2]-1):H(r,i,a,j[0],j[1],j[2])):e.ta&&Y>=e.ta[0]?n?(j=e.ta[0].split(":"),H(r,i,a,j[0],j[1],j[2]-1)):H(r,i,a+1):e.dc&&(q=c((a-1)/7)+1,F(q,e.dc,0)===q)?n?H(r,i,a-1):H(r,i,a+1):(u=v.call(t),e.d&&F(u+1,e.d,7)===u+1?n?H(r,i,a-1):H(r,i,a+1):e.wm&&(P=v.call(D(r,i,1)),L=c((a+P-1)/7+1),V=c((I+P-1)/7+1),(F(L,e.wm,V)||V)===L)?n?H(r,i,a-1):H(r,i,a+1):(E=D(r,i+1,0),I=d.call(E),e.D&&(F(a,e.D,I)||I)===a?n?H(r,i,a-1):H(r,i,a+1):(O=D(r,0,1,12),N=D(r+1,0,0,12),e.wy&&(S=H(r,i,a+4-(u||7)),k=H(h.call(S),0,1),U=4===v.call(O)||4===v.call(N)?53:52,C=o(((S.getTime()-k.getTime())/s+1)/7),(F(C,e.wy,U)||U)===C)?n?H(r,i,a-1):H(r,i,a+1):e.M&&F(i+1,e.M,12)===i+1?n?H(r,i-1):H(r,i+1):e.dy&&(W=o((t.getTime()-O.getTime())/s)+1,A=o((N.getTime()-O.getTime())/s)+1,(F(W,e.dy,A)||A)===W)?n?H(r,i-1):H(r,i+1):e.Y&&F(r,e.Y,0)===r?n?H(r-1):H(r+1):t)))},S=function(e,t,n,r){var i,a,u,l,f,g,O,S,E,N,Y,W,C,L,q,A,I,P,U,V,j,F,H,$,z,B=1e3,G=r?y:x,J=r?M:D;for(i=r?t:k(t,e);i&&B--;){if(n&&(!r&&i.getTime()>n.getTime()||r&&i.getTime()<n.getTime()))return null;if(l=h.call(i),f=m.call(i),g=d.call(i),e.Y&&(a=G(l,e.Y,0))!==l)i=!r&&a>l||r&&l>a?J(a):null;else{Y=D(l,0,1,12,0,0);var K=D(l,f,g,12,0,0);if(q=D(l+1,0,0),e.dy&&(I=o((K.getTime()-Y.getTime())/s)+1,j=o((q.getTime()-Y.getTime())/s)+1,((a=G(I,e.dy,j))||j)!==I))i=J(l,0,a);else if(e.M&&(a=G(f+1,e.M,12))!==f+1)i=J(l,a-1);else if(O=v.call(i),e.wy&&(W=J(l,f,g+4-(O||7),12),C=J(h.call(W),0,1,12),$=4===v.call(Y)||4===v.call(q)?53:52,P=o(((W.getTime()-C.getTime())/s+1)/7),((a=G(P,e.wy,$))||$)!==P))0>a&&(a+=1),i=J(h.call(W),m.call(W),d.call(W)-3+7*(a-P)+(r?6:0));else if(L=D(l,f+1,0,12),F=d.call(L),e.D&&((a=G(g,e.D,F))||F)!==g)i=J(l,f,0>a?0:a);else if(e.wm&&(H=v.call(D(l,f,1)),U=c((g+H-1)/7+1),z=c((F+H-1)/7+1),((a=G(U,e.wm,z))||z)!==U))i=0===a?J(l,f,a):J(l,f,7*(0>a?a+1:a-1)-(H-1)-(a>z&&6>v.call(L)?7:0)+(a===z+1?v.call(L)+1:0)+(r?6:0));else if(e.d&&(a=G(O+1,e.d,7))!==O+1)i=J(l,f,g+(a-1)-O);else{if(e.dc&&(V=c((g-1)/7)+1,(a=G(V,e.dc,0))!==V))if(r){if(a>0){i=J(l,f+(V>a?0:-1),7+7*(a-1));continue}if(0===a&&F-6>g){i=J(l,f,a);continue}}else{if(a>0){i=J(l,f+(V>a?1:0),1+7*(a-1));continue}if(1>a&&F-6>g){i=J(l,f,F-6);continue}}if(S=T.call(i),E=p.call(i),N=w.call(i),A=b(S)+":"+b(E)+":"+b(N),e.ta&&e.ta[0]>A)r?i=J(l,f,g-1):(u=e.ta[0].split(":"),i=J(l,f,g,u[0],u[1],u[2]));else if(e.tb&&A>=e.tb[0])r?(u=e.tb[0].split(":"),i=J(l,f,g,u[0],u[1],u[2]-1)):i=J(l,f,g+1);else if(e.h&&(a=G(S,e.h,24))!==S)i=J(l,f,g,a);else if(e.m&&(a=G(E,e.m,60))!==E)i=J(l,f,g,S,a);else if(e.s&&(a=G(N,e.s,60))!==N)i=J(l,f,g,S,E,a);else{if(!e.t||(a=G(A,e.t))===A)break;u=a.split(":");var Q=r?a>A?-1:0:A>a?1:0;i=J(l,f,g+Q,u[0],u[1],u[2])}}}}return B>0?i:null},k=function(e,t){var n=h.call(e)+E(t.aY),r=m.call(e)+E(t.aM),i=d.call(e)+f(E(t.aD),E(t.ady),E(t.ad),7*E(t.awy),7*E(t.awm)),a=T.call(e)+E(t.ah),u=p.call(e)+E(t.am),l=w.call(e)+E(t.as);return D(n,r,i,a,u,l)},E=function(e){return e&&e[0]?e[0]:0},N=function(t,n){return n?new Date(t.getTime()-1e3*e):new Date(t.getTime()+1e3*e)};return{isValid:function(e,t){t.setMilliseconds(0);var n=this.getNext(e,t);return n?t.getTime()===n.getTime():!1},get:function(e,t,n,r,i){for(var a,u=[];t-->0&&(a=i?this.getPrevious(e,a||n,r):this.getNext(e,a||n,r));)u.push(a),a=N(a,i);return u},getNext:function(e,t,n){for(var r,i=e?e.schedules||[]:[],a=e?e.exceptions||[]:[],u=i.length,l=a.length,s=t||new Date;s;){var o;if(n&&s.getTime()>n.getTime()){r=void 0;break}if(u)for(var c=0;u>c;c++)o=S(i[c],s,n),o&&(!r||o.getTime()<r.getTime())&&(r=o);else r=s;s=null,r&&l&&(o=this.getNextInvalid({schedules:a},r),o.getTime()!==r.getTime()&&(s=o,r=void 0))}return r},getNextInvalid:function(e,t){for(var n=e?e.schedules||[]:[],r=e?e.exceptions||[]:[],i=n.length,a=r.length,u=t||new Date;u&&this.isValid(e,u);){for(var l,s,o=0;i>o;o++){var c=O(n[o],u);c&&(!s||c.getTime()>s.getTime())&&(s=c)}a&&(l=this.getNext({schedules:r},u)),u=s||l?new Date(s&&l?Math.min(s.getTime(),l.getTime()):l||s):void 0}return u},getPrevious:function(e,t,n){var r,i,a=e?e.schedules||[]:[],u={schedules:e?e.exceptions||[]:[]},l=t||new Date,s=a.length;if(n&&t.getTime()<n.getTime())return null;if(0===s)r=l;else for(;s--;)i=S(a[s],l,n,!0),(!r||i>r)&&(r=i);return r&&u.schedules.length>0&&this.isValid(u,r)&&(r=this.getPrevious(e,N(r,!0),n)),r},exec:function(e,t,n,r){var a=this.getNext(e,N(t));return a?(a=a.getTime()-(new Date).getTime(),i=a>2147483647?setTimeout(this.exec,2147483647,e,t,n,r):setTimeout(this.handleExec,a,this,e,n,r),!0):void 0},stopExec:function(){i&&(clearTimeout(i),i=!1)},handleExec:function(e,t,n,r){n(r),i&&e.exec(t,new Date,n,r)}}},t="undefined"!=typeof exports&&null!==exports?exports:window;t.later=e}.call(this),function(){"use strict";var e=function(){var e,t,n,r,i,a,u,l,s,o=[],c=[],f=o,g=function(o,c,g){if(o=i?"a"+o:o,e||(f.push({}),e=f[0]),e[o]||(e[o]=[]),t=e[o],r){for(n=[],l=c;g>=l;l+=r)n.push(l);s={n:o,x:r,c:t.length,m:g}}n=a?[c]:u?[g]:n;var h=n.length;for(l=0;h>l;l+=1)0>t.indexOf(n[l])&&t.push(n[l]);n=r=i=a=u=0};return{schedules:o,exceptions:c,on:function(){return n=arguments[0]instanceof Array?arguments[0]:arguments,this},every:function(e){return r=e,this},after:function(e){return i=!0,n=[e],this},first:function(){return a=1,this},last:function(){return u=1,this},at:function(){n=arguments;for(var e=0,t=n.length;t>e;e++){var r=n[e].split(":");3>r.length&&(n[e]+=":00")}return g("t"),this},afterTime:function(){n=arguments;for(var e=0,t=n.length;t>e;e++){var r=n[e].split(":");3>r.length&&(n[e]+=":00")}return g("ta"),this},beforeTime:function(){n=arguments;for(var e=0,t=n.length;t>e;e++){var r=n[e].split(":");3>r.length&&(n[e]+=":00")}return g("tb"),this},second:function(){return g("s",0,59),this},minute:function(){return g("m",0,59),this},hour:function(){return g("h",0,23),this},dayOfMonth:function(){return g("D",1,u?0:31),this},dayOfWeek:function(){return g("d",1,7),this},onWeekend:function(){return n=[1,7],this.dayOfWeek()},onWeekday:function(){return n=[2,3,4,5,6],this.dayOfWeek()},dayOfWeekCount:function(){return g("dc",1,u?0:5),this},dayOfYear:function(){return g("dy",1,u?0:366),this},weekOfMonth:function(){return g("wm",1,u?0:5),this},weekOfYear:function(){return g("wy",1,u?0:53),this},month:function(){return g("M",1,12),this},year:function(){return g("Y",1970,2450),this},startingOn:function(e){return this.between(e,s.m)},between:function(t,n){return e[s.n]=e[s.n].splice(0,s.c),r=s.x,g(s.n,t,n),this},and:function(){return e=f[f.push({})-1],this},except:function(){return f=c,e=null,this}}},t="undefined"!=typeof exports&&null!==exports?exports:window;t.recur=e}.call(this),!later&&"undefined"!=typeof require)var later=require("later").later,recur=require("later").recur;(function(){"use strict";var e=function(e,t,n){var r=1e3,i=60*r,a=new Date(2050,0,1).getTime();e=e||30,t=t?new Date(t):new Date;var u={schedules:[]},l={},s=later(e*i,n),o=new Date,c=function(t,n,r,a){var s=t.assignedTo,o=t.dependsOn,c=t.earliestStartTime,f=void 0===t.remainingMin?t.estimatedTime:t.remainingMin,g=Math.min(f,u.rangeLength);if(0===f)return 0;if(c&&c.getTime()>n)return c.getTime();if(o)for(var h=0,m=o.length;m>h;h++){var d=r[o[h]];if(!d)return n+e*i;if(d>n)return d}if(void 0!==s){var v=l[s];if(!(n>=v.rangeStartTime))return v.rangeStartTime;g=Math.min(g,(v.rangeEndTime-n)/i),v.rangeStartTime=n+g*i,v.rangeLength=(v.rangeEndTime-v.rangeStartTime)/i}return a.push({id:t.id,startTime:new Date(n),endTime:new Date(n+g*i),length:g}),t.remainingMin=f-g,0>=t.remainingMin?(r[t.id]=n+g*i,0):n+e*i},f=function(e,t){o.setTime(t);var n,r;(n=s.getNext(e,o))?(e.rangeStartTime=n.getTime(),r=s.getNextInvalid(e,n),e.rangeEndTime=r?r.getTime():a,e.rangeLength=(e.rangeEndTime-e.rangeStartTime)/i):(e.rangeStartTime=e.rangeEndTime=void 0,e.rangeLength=0)},g=function(e){var n,r,i,a=[],s={},o=e.length;f(u,t),n=u.rangeStartTime;for(i in l)f(l[i],n);for(;n;){for(var g=0;o>g;g++){var h=c(e[g],n,s,a);h&&(!r||r>h)&&(r=h)}n=r,r=null,n>=u.rangeEndTime&&(f(u,n),n=u.rangeStartTime);for(i in l)n>=l[i].rangeEndTime&&f(l[i],n)}return a};return{project:function(e){return 0===arguments.length?u:(u=e,this)},people:function(e){return 0===arguments.length?l:(l=e,this)},tasks:function(e){var t,n;for(t=0,n=e.length;n>t;t++){var r=e[t].assignedTo;l[r]||(l[r]={})}return g(e)}}},t="undefined"!=typeof exports&&null!==exports?exports:window;t.schedule=e}).call(this);